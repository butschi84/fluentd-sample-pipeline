<label @FILTER_PIPELINE1>
    # filter the logs with tag syslog (syslog.**)

    # whitelist filter
    # ----------------
    # <filter syslog.**>
    #     @type grep
    #     <regexp>
    #         key message
    #         pattern /(?=.*(field=\w*)\b)/ # match logs like 'blabla field=some_value blabla'
    #     </regexp>
    # </filter>
    # <filter syslog.**>
    #     @type grep
    #     regexp1 message syslog\.syslog\.notice # only notice messages
    # </filter>

    
    <filter syslog.**>
        @type grep

        # whitelist filters
        <regexp>
            key message
            pattern /(?=.*(field=\w*)\b)/ # match logs like 'blabla field=some_value blabla'
        </regexp>
        
        # blacklist filters
        # -----------------
        <or>
            <exclude>
                key message
                pattern /syslog\.syslog\.debug/
            </exclude>
            <exclude>
                key message
                pattern /syslog\.syslog\.info/
            </exclude>
        </or>
    </filter>

    # forward logs to 03-dispatch
    <match syslog.**>
        @type relabel
        @label @DISPATCH_PIPELINE1
    </match>
</label>